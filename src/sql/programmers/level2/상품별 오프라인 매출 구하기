-- 상품 코드 별 매출액의 합계였는데, 테이블을 보니 ID별로 분류가 되어있어 ID로 GROUP BY를 했다.
-- 하지만 다른 사람들의 풀이를 보니 내 풀이는 출제자의 의도와는 벗어난 것 같다.

SELECT p.PRODUCT_CODE, p.PRICE*SUM(o.SALES_AMOUNT) as 'SALES'
FROM PRODUCT p
JOIN OFFLINE_SALE o
ON p.PRODUCT_ID = o.PRODUCT_ID
GROUP BY o.PRODUCT_ID
ORDER BY SALES DESC, p.PRODUCT_CODE;

-- 다른분의 풀이
-- 판매량을 상품 코드 별로 SUM 해주었다.
SELECT PRODUCT_CODE,SUM(PRICE * SALES_AMOUNT) AS SALES FROM PRODUCT
JOIN OFFLINE_SALE
ON PRODUCT.PRODUCT_ID = OFFLINE_SALE.PRODUCT_ID
GROUP BY PRODUCT_CODE
ORDER BY SALES DESC,PRODUCT_CODE