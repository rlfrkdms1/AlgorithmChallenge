-- 서브쿼리를 WHERE 절에도 사용하여 보다 효율적으로 사용할 수 있다.

SELECT FLAVOR
    FROM FIRST_HALF
    WHERE FLAVOR IN (SELECT FLAVOR FROM ICECREAM_INFO WHERE INGREDIENT_TYPE = 'fruit_based')
        AND TOTAL_ORDER>3000
    ORDER BY TOTAL_ORDER DESC;